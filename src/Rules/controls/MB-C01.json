{
  "control": "MB-C01",
  "title": "File & Folder Permissions",
  "rules": [
    {
      "id": "MB-R001",
      "title": "No chmod 777 (no world-writable files/dirs)",
      "control": "MB-C01",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "fs_no_world_writable",
          "args": {
            "path": ".",
            "max_results": 50
          }
        }
      ],
      "messages": {
        "pass": "No world-writable files or directories detected (chmod 777 not found).",
        "fail": "World-writable files or directories detected. Remove 777 and tighten permissions."
      }
    },
    {
      "id": "MB-R002",
      "title": "env.php permissions <= 0640",
      "control": "MB-C01",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "file_mode_max",
          "args": {
            "file": "app/etc/env.php",
            "max_octal": "0640"
          }
        }
      ],
      "messages": {
        "pass": "app/etc/env.php permissions are within safe range (<= 0640).",
        "fail": "app/etc/env.php permissions are too permissive. Set to 0640 (owner read/write, group read)."
      }
    },
    {
      "id": "MB-R003",
      "title": "Webroot hygiene (no .git/.env/backups in pub/)",
      "control": "MB-C01",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "webroot_hygiene",
          "args": {
            "webroot": "pub",
            "forbidden": [
              ".git",
              ".env",
              ".env.local",
              "*.bak",
              "*.old",
              "*~"
            ]
          }
        }
      ],
      "messages": {
        "pass": "Webroot is clean: no sensitive or backup artifacts exposed under pub/.",
        "fail": "Sensitive or backup artifacts found under pub/. Remove them to prevent exposure."
      }
    },
    {
      "id": "MB-R004",
      "title": "Code directories not group/other-writable",
      "control": "MB-C01",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "code_dirs_readonly",
          "args": {
            "dirs": [
              "app",
              "vendor",
              "lib"
            ]
          }
        }
      ],
      "messages": {
        "pass": "Code directories (app, vendor, lib) are not group/other-writable.",
        "fail": "One or more code directories are group/other-writable. Tighten to read-only for non-owners."
      }
    },
    {
      "id": "MB-R005",
      "title": "Directory listing disabled",
      "control": "MB-C01",
      "severity": "medium",
      "op": "any",
      "checks": [
        {
          "name": "http_no_directory_listing",
          "args": {
            "paths": [
              "/media/",
              "/static/",
              "/errors/",
              "/var/"
            ],
            "timeout_ms": 8000
          }
        }
      ],
      "messages": {
        "pass": "Directory listing is disabled for public paths.",
        "fail": "Directory listing is enabled on at least one public path. Disable autoindex/listing."
      }
    }
  ]
}