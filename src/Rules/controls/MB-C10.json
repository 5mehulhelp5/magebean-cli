{
  "control": "MB-C10",
  "title": "Abandoned Extensions Removal",
  "rules": [
    {
      "id": "MB-R061",
      "title": "No packages marked 'abandoned' on Packagist",
      "control": "MB-C10",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "composer_abandoned_offline",
          "args": {
            "lock_file": "composer.lock",
            "packagist_meta": "rules/packagist-abandoned.json"
          }
        }
      ],
      "messages": {
        "pass": "No installed packages are marked as 'abandoned' on Packagist.",
        "fail": "Abandoned packages detected. Replace them or switch to the recommended alternatives."
      }
    },
    {
      "id": "MB-R062",
      "title": "No packages without release in > 24 months",
      "control": "MB-C10",
      "severity": "medium",
      "op": "all",
      "checks": [
        {
          "name": "composer_release_recency_offline",
          "args": {
            "lock_file": "composer.lock",
            "release_meta": "rules/release-history.json",
            "months": 24
          }
        }
      ],
      "messages": {
        "pass": "All packages have had a release within the last 24 months.",
        "fail": "Stale packages found (no release > 24 months). Replace or fork and maintain internally."
      }
    },
    {
      "id": "MB-R063",
      "title": "No packages from archived repositories",
      "control": "MB-C10",
      "severity": "medium",
      "op": "all",
      "checks": [
        {
          "name": "composer_repo_archived_offline",
          "args": {
            "lock_file": "composer.lock",
            "repo_meta": "rules/repo-status.json"
          }
        }
      ],
      "messages": {
        "pass": "No installed packages come from archived repositories.",
        "fail": "Packages from archived repositories detected. Migrate to active upstreams."
      }
    },
    {
      "id": "MB-R064",
      "title": "No risky forks replacing upstream libs",
      "control": "MB-C10",
      "severity": "medium",
      "op": "all",
      "checks": [
        {
          "name": "composer_risky_fork_offline",
          "args": {
            "lock_file": "composer.lock",
            "repo_meta": "rules/repo-status.json"
          }
        }
      ],
      "messages": {
        "pass": "No risky forks detected replacing upstream libraries.",
        "fail": "Risky forks detected. Prefer official upstreams or vetted, actively maintained forks."
      }
    }
  ]
}
