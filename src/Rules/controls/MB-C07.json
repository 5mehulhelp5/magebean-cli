{
  "control": "MB-C07",
  "title": "Logging & Monitoring",
  "rules": [
    {
      "id": "MB-R042",
      "title": "Logs and reports not exposed under pub/",
      "control": "MB-C07",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "webroot_hygiene",
          "args": {
            "webroot": "pub",
            "forbidden": ["var/log", "var/report"]
          }
        }
      ]
    },
    {
      "id": "MB-R043",
      "title": "Log rotation configured",
      "control": "MB-C07",
      "severity": "medium",
      "op": "all",
      "checks": [
        {
          "name": "text_grep",
          "args": {
            "file": "devops/logrotate.conf",
            "must_match": ["rotate", "compress"]
          }
        }
      ]
    },
    {
      "id": "MB-R044",
      "title": "Debug template hints disabled in production",
      "control": "MB-C07",
      "severity": "medium",
      "op": "all",
      "checks": [
        {
          "name": "php_array_eq",
          "args": {
            "file": "app/etc/env.php",
            "path": "dev/debug/template_hints_storefront",
            "equals": 0
          }
        }
      ]
    },
    {
      "id": "MB-R045",
      "title": "PII not logged in application logs",
      "control": "MB-C07",
      "severity": "high",
      "op": "all",
      "checks": [
        {
          "name": "code_grep",
          "args": {
            "paths": ["app"],
            "include_ext": ["php"],
            "must_not_match": [
              "logger->(info|debug|notice)\\([^)]*password",
              "logger->(info|debug|notice)\\([^)]*Authorization",
              "logger->(info|debug|notice)\\([^)]*(card_number|cvv)"
            ]
          }
        }
      ]
    }
  ]
}
